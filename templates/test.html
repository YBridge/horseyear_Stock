<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æµ‹è¯•é¡µé¢</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #1a1a2e;
            color: #fff;
        }
        #result {
            margin-top: 20px;
            padding: 15px;
            background: #333;
            border-radius: 8px;
        }
        button {
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            margin: 5px;
        }
    </style>
</head>
<body>
    <h1>ğŸš€ è‚¡ç¥¨APIæµ‹è¯•é¡µé¢</h1>
    <div>
        <input type="text" id="symbol" value="AAPL" placeholder="è¾“å…¥è‚¡ç¥¨ä»£ç ">
        <button onclick="testAPI()">æµ‹è¯•API</button>
    </div>
    <div id="result">ç‚¹å‡»æŒ‰é’®æµ‹è¯•...</div>

    <script>
        function testAPI() {
            const symbol = document.getElementById('symbol').value;
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = '<p>æ­£åœ¨è·å–æ•°æ®...</p>';

            fetch('/get_all_data', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({symbol: symbol})
            })
            .then(res => res.json())
            .then(data => {
                console.log('APIè¿”å›:', data);
                if (data.success) {
                    const d = data.data;
                    resultDiv.innerHTML = `
                        <h2>${d.symbol} - ${d.name}</h2>
                        <p><strong>ä»·æ ¼:</strong> $${d.price.toFixed(2)}</p>
                        <p><strong>æ¶¨è·Œ:</strong> <span style="color: ${d.change >= 0 ? '#22c55e' : '#ef4444'}">${d.change >= 0 ? '+' : ''}${d.change.toFixed(2)} (${d.change_pct.toFixed(2)}%)</span></p>
                        <p><strong>å¸‚å€¼:</strong> $${(d.market_cap / 1e12).toFixed(2)}T</p>
                        <p><strong>å¸‚ç›ˆç‡:</strong> ${d.pe_ratio}</p>
                        <p><strong>RSI:</strong> ${d.rsi}</p>
                        <p><strong>è¶‹åŠ¿:</strong> ${d.trend}</p>
                    `;
                } else {
                    resultDiv.innerHTML = `<p style="color: #ef4444">é”™è¯¯: ${data.error}</p>`;
                }
            })
            .catch(err => {
                console.error('é”™è¯¯:', err);
                resultDiv.innerHTML = `<p style="color: #ef4444">ç½‘ç»œé”™è¯¯: ${err.message}</p>`;
            });
        }

        // é¡µé¢åŠ è½½åè‡ªåŠ¨æµ‹è¯•
        window.onload = function() {
            console.log('é¡µé¢åŠ è½½å®Œæˆ');
            setTimeout(testAPI, 500);
        };
    </script>
</body>
</html>
